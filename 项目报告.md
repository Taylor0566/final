# 深圳大学课程项目报告

**课程名称：** Web开发及人机交互导论  
**项目名称：** 期末大作业-校园活动管理平台  
**学院：** 计算机与软件学院  
**专业：** 计算机科学与技术（卓越班）  
**任课教师：** 李俊杰  
**报告人：** 梁升富  
**学号：** 2023152006  
**提交时间：** 2025.12.31  

---

## 摘要

本项目旨在设计并实现一个功能全面、交互友好的“校园活动管理平台”。平台以服务全校师生为核心，围绕活动的发布、发现、参与和管理四大环节，构建了一个完整的信息闭环。主要功能涵盖：一个动态更新、支持分类筛选与关键词搜索的**活动中心**；集图文介绍、在线报名、收藏、评论互动、扫码分享及日历（ICS）导出于一体的**活动详情页**；一个让用户可以方便地查看和管理自己已报名、已收藏活动的**个人中心**；基于 ECharts 实现的，从多个维度（如活动类型分布、热度趋势、主办方排行等）对校园活动数据进行可视化分析的**统计看板**；以及直观展示每日活动的**活动日历**和用于收集用户建议的**意见反馈**系统。

为了在传统多页面应用（MPA）架构下实现流畅的类单页面应用（SPA）体验，项目巧妙地运用 `localStorage` 进行状态持久化，确保了用户登录信息、活动数据在页面跳转间的无缝传递。项目整体采用响应式布局设计，兼容桌面和移动设备，并通过统一的导航栏和集中的脚本管理，保证了代码的模块化与可维护性。

---

## 1．网页页面结构规划与内容设计

项目的设计初心是打造一个信息清晰、操作便捷、体验流畅的校园活动门户。为此，我们对平台的整体结构和每个页面的内容进行了细致的规划。

*   **统一的顶部导航栏**：这是贯穿整个平台的主动脉。我们将其设计为固定在页面顶部，包含了“首页”、“活动日历”、“发布活动”、“统计分析”、“意见反馈”和“个人中心”等核心功能入口。这样的设计确保了用户无论身处哪个页面，都能快速、明确地跳转到目标模块，提供了稳定、一致的导航预期。在移动端，该导航栏会智能地折叠成一个汉堡菜单，以节省宝贵的屏幕空间。

*   **首页 (`index.html`)**：作为平台的门面，首页的设计重点是“引导”和“发现”。
    *   **内容设计**：页面顶部是醒目的**滚动宣传卡片**，用于推广精选或热门活动。紧接着是**分类筛选器**，允许用户按“学术”、“艺术”、“体育”等类别快速过滤感兴趣的内容。页面的核心是**活动网格**，以卡片形式直观展示活动海报、标题和基本信息。搜索框具备**实时搜索建议**功能，用户输入关键词时，会动态匹配并展示相关活动，极大地提升了搜索效率。
    *   **结构规划**：我们采用“上中下”的经典布局，顶部导航，中部核心内容，底部页脚。这种结构符合大多数用户的浏览习惯，逻辑清晰，重点突出。

*   **活动详情页 (`detail.html`)**：这是用户深入了解和参与活动的“最后一公里”，设计重点是“详尽”与“互动”。
    *   **内容设计**：页面以大尺寸的**活动海报**作为视觉焦点。主体部分详细展示了活动的**基本信息**（时间、地点、主办方）、丰富的**图文详情**、以及一个开放的**评论区**。核心交互功能包括**“立即报名”**和**“收藏”**按钮。此外，我们还加入了**二维码分享**和**ICS日历文件导出**功能，方便用户将活动分享给朋友或添加到自己的日程管理工具中。
    *   **结构规划**：采用左侧信息展示、右侧操作面板（或上下布局）的结构，让用户在阅读详情的同时，可以随时进行报名、收藏等操作。

*   **活动发布页 (`publish.html`)**：为活动组织者设计，重点是“便捷”和“规范”。页面提供了一个结构化的**表单**，引导用户逐项填写活动标题、时间、地点、类型、人数限制、主办方和详细介绍等所有必要信息，确保了平台活动信息的完整性和一致性。

*   **统计分析页 (`stats.html`)**：这是一个数据驱动的决策支持模块。我们选用强大的 ECharts 图表库，将后台数据转化为直观的**可视化图表**，包括：分析各类活动占比的**饼图**、展示活动发布数量变化的**折线图**、对比不同主办方活动数量的**柱状图**，以及综合评估活动各项指标的**雷达图**。

*   **活动日历页 (`calendar.html`)**：提供一个以“月”为单位的**日历视图**。用户可以直观地看到整个月中哪些天有活动，点击具体日期，下方会联动展示当日的所有活动列表，为用户的长期规划提供了便利。

*   **意见反馈页 (`feedback.html`)**：为了提升用户体验，我们设计了一个**卡片化**的反馈表单，视觉上更轻盈、友好。表单包含**分段式问题类型选择**、标题、详细描述和联系方式输入框。提交按钮固定在页脚，无论用户在页面的哪个位置，都能方便地完成提交。

*   **个人中心 (`profile.html`)**：用户的专属空间。页面顶部是可自定义的**封面和个人信息**，下方通过标签页（Tabs）清晰地划分了**“我的活动”**（已报名）、**“我的收藏”**和**“我的动态”**等模块，方便用户追踪和管理与自己相关的活动。

---

## 2．网页的实现（主要步骤解释及实现代码等）

在实现层面，我们以原生 JavaScript (ES6) 和 jQuery 为主要技术栈，配合 Bootstrap 5 进行响应式布局，并利用 ECharts 进行数据可视化。核心的挑战在于如何在没有后端和前端框架的情况下，构建一个体验流畅、状态可控的多页面应用。

### 2.1 核心机制：跨页面导航与状态持久化

**问题背景**：作为一个多页面的网站，当用户从首页跳转到详情页，或者登录后返回上一页时，如何保持他的登录状态或保留已有的活动数据？如果完全依赖服务器，每次页面加载都会重新请求，体验不佳。

**解决方案**：我们设计了一套基于浏览器 `localStorage` 的客户端状态持久化机制。`localStorage` 允许我们在用户浏览器中存储少量数据，且这些数据在浏览器关闭后依然存在。

**实现步骤**：
1.  **定义状态**：首先，我们在全局脚本 `assets/app.js` 中定义了两个关键的存储键（`LS_EVENTS_KEY` 和 `LS_USER_KEY`），分别用于存储所有的活动数据和当前登录用户的信息。

2.  **封装状态读写函数**：我们创建了 `loadState()`、`saveEvents()` 和 `saveUser()` 三个核心函数。
    *   `loadState()`: 在应用初始化时调用，尝试从 `localStorage` 中读取并解析（`JSON.parse`）活动和用户信息，将其加载到内存的变量（`events` 和 `currentUser`）中。
    *   `saveEvents()` / `saveUser()`: 当活动数据（如新增活动、报名）或用户信息（如登录、注销）发生变化时，调用这两个函数。它们会将内存中的JavaScript对象序列化为JSON字符串（`JSON.stringify`），然后存入 `localStorage`。

    ```javascript
    // assets/app.js: 状态管理核心代码
    var LS_EVENTS_KEY = 'campushub_events';
    var LS_USER_KEY = 'campushub_user';
    var events = []; // 内存中的活动数据
    var currentUser = null; // 内存中的用户数据

    function loadState() {
        try {
            var eventsString = localStorage.getItem(LS_EVENTS_KEY);
            if (eventsString) {
                events = JSON.parse(eventsString);
            }
            var userString = localStorage.getItem(LS_USER_KEY);
            if (userString) {
                currentUser = JSON.parse(userString);
            }
        } catch (e) {
            console.error("Failed to load state from localStorage", e);
        }
    }

    function saveEvents() {
        try {
            localStorage.setItem(LS_EVENTS_KEY, JSON.stringify(events));
        } catch (e) {
            console.error("Failed to save events to localStorage", e);
        }
    }

    function saveUser() {
        try {
            if (currentUser) {
                localStorage.setItem(LS_USER_KEY, JSON.stringify(currentUser));
            } else {
                localStorage.removeItem(LS_USER_KEY); // 注销时清除用户数据
            }
        } catch (e) {
            console.error("Failed to save user to localStorage", e);
        }
    }
    ```

3.  **统一导航函数**：为了集中管理页面跳转，我们创建了 `navigate(view, params)` 函数。此函数不仅负责跳转，更承担了在跳转前**自动保存状态**的职责。
    *   它通过一个 `map` 对象，将抽象的视图名称（如 `ViewState.DETAIL`）映射到实际的HTML文件名（如 `detail.html`）。
    *   它能处理URL参数。例如，跳转到详情页时，会将活动ID（`params.id`）作为查询字符串（`?id=...`）拼接到URL上。
    *   最关键的是，在执行 `window.location.href` 跳转之前，它会先调用 `saveUser()` 和 `saveEvents()`，确保任何未保存的更改都已持久化。

    ```javascript
    // assets/app.js: 统一页面导航函数
    function navigate(view, params) {
        var map = {
            HOME: 'index.html',
            DETAIL: 'detail.html',
            PUBLISH: 'publish.html',
            STATS: 'stats.html',
            CALENDAR: 'calendar.html',
            FEEDBACK: 'feedback.html',
            PROFILE: 'profile.html',
            LOGIN: 'login.html',
            REGISTER: 'register.html'
        };
        var url = map[view] || 'index.html';

        if (view === ViewState.DETAIL && params && params.id) {
            url += '?id=' + encodeURIComponent(params.id);
        }
        
        // 在跳转前保存所有状态
        saveUser();
        saveEvents();
        
        window.location.href = url;
    }
    ```

通过这套机制，我们成功地在多个独立的HTML页面之间建立起了状态共享的桥梁，极大地提升了用户体验的连贯性。

### 2.2 首页实现：活动展示、分类筛选与搜索建议

首页是用户与平台交互的第一站，其实现重点在于高效地展示信息和快速地响应用户操作。

**实现步骤**：
1.  **动态渲染活动网格**：`renderHome()` 函数是首页渲染的核心。
    *   它首先会根据用户选择的**分类（`filter`）**和输入的**搜索词（`searchTerm`）**，对内存中的 `events` 数组进行双重过滤。
    *   接着，它会清空现有的活动网格（`#event-grid`），然后遍历筛选后的活动列表。
    *   对于每一个活动，它会动态创建一个Bootstrap卡片（`div.card`），填充上活动的图片、标题、日期等信息，并将其追加到网格中。
    *   每个卡片都被绑定了一个点击事件，点击后调用 `navigate(ViewState.DETAIL, { id: ev.id })`，将用户引导至对应的详情页。

2.  **分类筛选功能**：`renderHome()` 函数在执行时，也会动态生成分类按钮。它会检查当前的 `filter` 值，为对应的分类按钮添加 `btn-dark` 的激活样式，并为每个按钮绑定点击事件。点击后，更新全局 `filter` 变量，并重新调用 `renderHome()` 来刷新视图。

3.  **搜索建议（联想）**：为了优化搜索体验，我们实现了 `updateSearchInput()` 函数。
    *   该函数在搜索框的 `input` 事件上触发。
    *   它获取输入框的当前值，并与 `events` 数组中的活动标题和分类进行模糊匹配。
    *   如果找到匹配项，它会创建一个下拉建议框（`#search-suggest`），将匹配度最高的几个活动展示出来，并为每个建议项绑定点击事件，直接跳转到该活动的详情页。
    *   如果没有输入或没有匹配项，则隐藏建议框。

    ```javascript
    // assets/app.js: 首页渲染与交互的部分实现
    function renderHome() {
        // ... 分类按钮渲染逻辑 ...

        var grid = $('#event-grid');
        grid.empty(); // 清空旧内容
        var term = searchTerm.toLowerCase();
        
        // 过滤活动
        var filteredEvents = events.filter(function(e) {
            var matchesSearch = (e.title.toLowerCase().indexOf(term) > -1 || e.description.toLowerCase().indexOf(term) > -1);
            var matchesFilter = (filter === 'all' || e.category === filter);
            return matchesSearch && matchesFilter;
        });

        // 渲染卡片
        filteredEvents.forEach(function(ev) {
            var card = $('<div class="col-md-4 mb-4">...</div>'); // 卡片HTML结构
            // ... 填充卡片内容 ...
            card.on('click', function() {
                navigate(ViewState.DETAIL, { id: ev.id });
            });
            grid.append(card);
        });
    }
    ```

### 2.3 活动详情页实现：动态内容加载与核心交互

详情页需要根据URL中的ID，动态展示特定活动的信息。

**实现步骤**：
1.  **解析URL参数**：`renderDetail()` 函数首先通过 `URLSearchParams` API 从 `window.location.search` 中解析出 `id` 参数。
2.  **查找数据并渲染**：根据获取到的 `id`，在 `events` 数组中找到对应的活动对象。如果找不到，则显示错误信息或跳转回首页。找到后，使用jQuery将活动的标题、海报、图文详情、评论等信息填充到页面的各个DOM元素中。
3.  **报名与收藏功能**：
    *   按钮的状态（例如，显示“报名”还是“已报名”）会根据 `currentUser` 是否在活动的 `registeredUsers` 数组中来决定。
    *   点击按钮时，会更新 `events` 数组中对应活动的数据（添加或移除用户ID），然后立即调用 `saveEvents()` 将更改持久化到 `localStorage`，并重新渲染按钮状态，实现即时反馈。
4.  **ICS文件生成与导出**：当用户点击“添加到日历”时，我们会动态生成一个符合 iCalendar 规范的文本字符串，包含活动的标题、时间、地点等信息。然后，通过创建一个 `Blob` 对象和 `<a>` 标签的 `download` 属性，将该字符串作为 `.ics` 文件触发浏览器下载。

### 2.4 数据可视化：ECharts的应用

统计页 `stats.html` 的核心是 `renderStats()` 函数。

**实现步骤**：
1.  **数据聚合**：在渲染图表前，我们需要先对 `events` 数组进行处理，聚合出图表所需的数据。例如，要渲染饼图，我们需要统计每个分类（`category`）下有多少个活动。
2.  **初始化ECharts实例**：为每个图表容器（如 `#echarts-pie`）调用 `echarts.init()` 来创建一个ECharts实例。
3.  **配置与渲染**：为每个实例构建一个 `option` 配置对象，将聚合好的数据填入 `series` 中，并设置好标题、图例、坐标轴等样式。最后，调用实例的 `setOption(option)` 方法，ECharts便会自动将数据渲染成绚丽的图表。

    ```javascript
    // assets/app.js: ECharts渲染示例
    function renderStats() {
        // 1. 数据聚合
        var categoryCounts = events.reduce(function(acc, ev) {
            acc[ev.category] = (acc[ev.category] || 0) + 1;
            return acc;
        }, {});
        var pieData = Object.keys(categoryCounts).map(function(key) {
            return { name: key, value: categoryCounts[key] };
        });

        // 2. 初始化实例
        var pieChart = echarts.init(document.getElementById('echarts-pie'));
        
        // 3. 配置与渲染
        var pieOption = {
            title: { text: '活动分类占比' },
            series: [{
                type: 'pie',
                radius: '50%',
                data: pieData
            }]
        };
        pieChart.setOption(pieOption);

        // ... 其他图表（折线图、柱状图等）的实现与此类似 ...
    }
    ```

---

## 2．网页的实现（详细重写）

项目采用原生 JavaScript + jQuery 进行页面渲染与交互，Bootstrap 5 提供响应式布局，ECharts 用于统计可视化；状态通过 `localStorage` 在多页面间持久化，保证无后端条件下的流畅体验。

### 2.1 全局架构与初始化

- 视图枚举与导航映射，统一跳转前保存状态（`assets/app.js:245–267`）。
- 启动流程在 `init()` 中按页面标识选择渲染函数（`assets/app.js:1630–1641`）。
- 状态持久化键为 `campushub_events` 与 `campushub_user`，加载后进行图片来源本地化校验。

```javascript
function loadState(){ /* 读取 localStorage 并解析 */ }
function saveEvents(){ localStorage.setItem(LS_EVENTS_KEY, JSON.stringify(events)); }
function saveUser(){ /* 按是否登录写入或清除 */ }
function navigate(view, params){ /* 统一跳转并保存状态 */ }
```

### 2.2 首页（index.html）

结构是如何实现的：

分点1：顶部导航与移动端菜单采用固定顶部的半透明暗色导航栏，实现跨页面统一入口与响应式适配。桌面端以 `flex` 横向排列品牌区、功能入口、搜索与认证区域；移动端通过“汉堡按钮”展开折叠菜单，复用同一套 `data-view` 约定触发页面跳转，减少维护成本并保持交互一致性。

代码位置：`index.html:11–68`

```html
<nav class="nav-dark sticky-top">
  <div class="container d-flex align-items-center justify-content-between py-2">
    <div class="d-flex align-items-center"><span class="brand">CampusHub</span></div>
    <div class="d-none d-md-flex align-items-center gap-3">
      <span class="nav-item" data-view="HOME">首页</span>
      <span class="nav-item" data-view="CALENDAR">日历</span>
      <span class="nav-item" data-view="PUBLISH">发布</span>
      <span class="nav-item" data-view="STATS">统计</span>
      <span class="nav-item" data-view="FEEDBACK">反馈</span>
      <span class="nav-item" data-view="PROFILE">个人中心</span>
    </div>
    <div class="d-none d-md-flex align-items-center gap-3">
      <div class="position-relative" id="search-wrapper">
        <input id="search-input" class="search-input" type="text" placeholder="搜索活动..." />
        <div id="search-suggest" class="suggest-dropdown d-none"></div>
      </div>
      <div id="auth-area" class="d-flex align-items-center gap-2"></div>
    </div>
    <button class="btn btn-link text-light d-md-none" id="mobile-menu-btn">☰</button>
  </div>
  <div id="mobile-menu" class="d-md-none mobile-menu d-none">
    <div class="container py-3">
      <div class="mb-3">
        <input id="m-search-input" class="search-input w-100" type="text" placeholder="搜索活动..." />
      </div>
      <div class="d-flex flex-column gap-3">
        <span class="nav-item" data-view="HOME">首页</span>
        <span class="nav-item" data-view="CALENDAR">日历</span>
        <span class="nav-item" data-view="HOME" data-anchor="activities">活动列表</span>
        <span class="nav-item" data-view="PUBLISH">发布</span>
        <span class="nav-item" data-view="STATS">统计</span>
        <span class="nav-item" data-view="FEEDBACK">反馈</span>
        <span class="nav-item" data-view="PROFILE">个人中心</span>
      </div>
      <div class="pt-3 border-top"><div id="m-auth-area" class="d-flex flex-column gap-2"></div></div>
    </div>
  </div>
</nav>
```

分点2：视觉横幅以三层结构实现沉浸感：底层为覆盖全屏的背景图，中层为纵向渐变叠加，顶层为居中的标题、副文与主按钮。通过绝对定位与半透明渐变叠层，保证文字可读性与图像对比度，同时在不同屏幕高度下保持视觉比例一致。

代码位置：`index.html:72–90`，样式参见 `assets/styles.css:88–117`

```html
<div class="hero">
  <img class="hero-bg" src="assets/img/hero-bg.jpg" alt="" />
  <div class="hero-overlay"></div>
  <div class="container text-center hero-content">
    <h1 class="hero-title">校园生活，<br class="d-md-none" />从此不同。</h1>
    <p class="hero-sub">探索数百个精彩活动，结识志同道合的伙伴。CampusHub 为你连接无限可能。</p>
    <button class="btn btn-light btn-lg rounded-pill fw-semibold" id="btn-explore">开始探索</button>
  </div>
</div>
```

分点3：精选滑动区采用连续轨道与循环内容的组合，实现无缝滚动。轨道元素通过 `white-space:nowrap` 与 CSS `@keyframes` 做线性平移动画，JavaScript 将素材数组复制拼接三倍以避免尾端空白，形成稳定的走马灯视觉效果。

代码位置：结构 `index.html:91–94`，渲染 `assets/app.js:445–456`

```html
<div class="slider-wrap bg-apple-gray py-4">
  <h2 class="text-center fw-bold mb-3">精选活动瞬间</h2>
  <div class="slider-track" id="continuous-slider"></div>
</div>
```

```javascript
var track = $('#continuous-slider');
track.empty();
var display = promos.concat(promos).concat(promos);
display.forEach(function(src){
  var card = $('<div class="slider-card"></div>');
  card.append('<div class="rounded-2xl shadow-soft" style="width:22rem;height:13rem;overflow:hidden"><img src="'+src+'" style="width:100%;height:100%;object-fit:cover"></div>');
  track.append(card);
});
```

分点4：活动网格与分类筛选以容器分区组合实现。上方为可水平滚动的分类按钮区，采用“全部/学术/艺术/体育/社交”五类切换；下方为自适应栅格卡片列表，卡片内包含海报、标题、日期、地点与报名人数信息，点击卡片直接导航到详情页，串联首页与详情的发现路径。

代码位置：结构 `index.html:95–115`，卡片生成 `assets/app.js:499–527`

```html
<div class="container my-4" id="activities">
  <div class="d-flex flex-column flex-md-row align-items-center justify-content-between mb-3">
    <h2 class="fw-bold">热门活动</h2>
    <div class="d-flex gap-2 overflow-auto no-scrollbar" id="category-filter"></div>
  </div>
  <div class="row g-4" id="event-grid"></div>
</div>
```

```javascript
var col = $('<div class="col-12 col-sm-6 col-lg-3"></div>');
var card = $('<div class="card-evt"></div>');
var imgWrap = $('<div class="card-evt-img"></div>');
imgWrap.append('<img src="'+event.imageUrl+'">');
imgWrap.append('<div class="badge-cat">'+event.category.toUpperCase()+'</div>');
card.append(imgWrap);
var body = $('<div class="p-3"></div>');
body.append('<h6 class="fw-semibold mb-2">'+event.title+'</h6>');
body.append('<div class="evt-meta">'+date+'<span class="dot">•</span>'+event.location+'<span class="dot">•</span>'+event.attendees+' / '+event.maxAttendees+' 已报名</div>');
card.append(body);
card.on('click', function(){ navigate(ViewState.DETAIL, { id: event.id }); });
col.append(card); grid.append(col);
```

样式是如何实现的：

分点1：横幅样式通过多层绝对定位元素与渐变叠加提升层次。`hero` 设定最小视口高度与溢出隐藏，`hero-bg` 全屏覆盖并调低不透明度，`hero-overlay` 使用纵向线性渐变自上而下过渡到页面背景，确保文字清晰。

代码位置：`assets/styles.css:88–117`

```css
.hero{position:relative;min-height:70vh;overflow:hidden;background:#000}
.hero-bg{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:.7}
.hero-overlay{position:absolute;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,.6),transparent,#f5f5f7)}
.hero-content{position:relative;padding-top:10vh;padding-bottom:10vh}
.hero-title{color:#fff;font-weight:800;letter-spacing:-.01em;font-size:calc(2rem + 2vh);margin-bottom:1rem}
.hero-sub{color:#ddd;font-size:1.2rem;max-width:52ch;margin:0 auto 1rem}
```

分点2：精选滑动区以无断点的滚动动画呈现。`slider-track` 设置 `white-space:nowrap` 并绑定 `scroll` 关键帧，匀速平移内容；卡片采用圆角与柔和阴影，避免视觉疲劳并与整体风格统一。

代码位置：`assets/styles.css:130–154`

```css
.slider-wrap{overflow:hidden}
.slider-track{white-space:nowrap;animation:scroll 40s linear infinite}
.slider-card{display:inline-block;padding:0 1rem}
@keyframes scroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
```

分点3：活动卡片强调图片动效与信息层级。`card-evt` 定义圆角、边框与悬停态，`card-evt-img` 控制海报高度与裁剪，子选择器增强悬停缩放；右上角 `badge-cat` 作为类别标识，配合 `evt-meta` 展示日期与地点等细节。

代码位置：`assets/styles.css:229–266,268–273`

```css
.card-evt{background:#fff;border-radius:20px;border:1px solid #eee;overflow:hidden;transition:.4s transform,.4s box-shadow}
.card-evt:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.1)}
.card-evt-img{height:190px;overflow:hidden;position:relative}
.card-evt-img img{width:100%;height:100%;object-fit:cover;transition:transform .6s}
.card-evt:hover .card-evt-img img{transform:scale(1.08)}
.badge-cat{position:absolute;top:.5rem;right:.5rem;background:rgba(255,255,255,.9);padding:.25rem .5rem;border-radius:8px;font-weight:700;color:#0071e3;font-size:.75rem}
.evt-meta{font-size:.9rem;color:#6b7280}
.evt-meta .dot{margin:0 .5rem}
```

分点4：搜索输入与联想下拉采用玻璃拟态风格，提升与导航栏的整体感受。输入框以半透明背景和圆角实现轻盈观感，下拉建议采用轻模糊与浅色边框，建议项对齐缩略图与文本方便快速定位结果。

代码位置：`assets/styles.css:52–61,63–84`

```css
.search-input{padding:.4rem .8rem .4rem 2rem;border-radius:999px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.1);color:#fff}
.suggest-dropdown{position:absolute;top:110%;left:0;right:0;background:rgba(255,255,255,.1);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.1);border-radius:16px;overflow:hidden}
.suggest-item{display:flex;align-items:center;gap:.5rem;padding:.5rem .75rem;color:#fff;cursor:pointer}
.suggest-item:hover{background:rgba(255,255,255,.1)}
```

功能是如何实现的：

分点1：`renderHome()` 负责首页主逻辑，包括生成分类按钮、过滤活动、渲染卡片与绑定点击导航。过滤采用标题与描述的双关键字匹配，再与类别条件组合，确保搜索与分类的协同工作，提升信息查找效率与准确度。

代码位置：`assets/app.js:436–529`

```javascript
function renderHome(){
  var promos=[/* ... */];
  var cf=$('#category-filter'); cf.empty();
  ['all','academic','arts','sports','social'].forEach(function(cat){
    var txt=cat==='all'?'全部':cat==='academic'?'学术':cat==='arts'?'艺术':cat==='sports'?'体育':'社交';
    var active=filter===cat;
    var btn=$('<button class="btn btn-pill '+(active?'btn-dark':'btn-light')+'"></button>');
    btn.text(txt); btn.on('click',function(){ filter=cat; renderHome(); }); cf.append(btn);
  });
  var grid=$('#event-grid'); grid.empty();
  var term=searchTerm.toLowerCase();
  var filtered=events.filter(function(e){
    var m=e.title.toLowerCase().indexOf(term)>-1||e.description.toLowerCase().indexOf(term)>-1;
    var c=filter==='all'||e.category===filter; return m&&c;
  });
  if(filtered.length===0){ grid.append('<div class="col-12"><div class="text-center text-secondary py-5">没有找到相关活动</div></div>'); }
  else{
    filtered.forEach(function(event){ /* 卡片生成与点击导航 */ });
  }
}
```

分点2：搜索建议通过 `updateSearchInput()` 在输入事件上动态计算建议列表，限制最多五条并按标题与类别匹配，同步显示日期信息。点击建议项后直接跳转到详情页，清空输入与隐藏建议框，避免环境状态残留干扰后续操作。

代码位置：`assets/app.js:360–399`

```javascript
function updateSearchInput(){
  var term=searchTerm.toLowerCase();
  var list=events.filter(function(e){
    return e.title.toLowerCase().indexOf(term)>-1||e.category.indexOf(term)>-1;
  }).slice(0,5);
  var box=$('#search-suggest'); box.empty();
  if(term&&list.length){ /* 渲染建议项并绑定点击 */ box.removeClass('d-none'); }
  else{ box.addClass('d-none'); }
}
```

分点3：`bindSearch()` 负责建议框的显示/隐藏与移动端输入联动。通过文档级 `mousedown` 事件判断点击是否在建议容器外部，及时关闭浮层；移动端输入后使用轻跳转返回首页刷新渲染，保持统一的查询体验与数据来源。

代码位置：`assets/app.js:400–417`

```javascript
function bindSearch(){
  var w=$('#search-wrapper');
  $(document).on('mousedown',function(e){ if(!w[0].contains(e.target)){ $('#search-suggest').addClass('d-none'); }});
  $('#search-input').on('focus input',function(){ searchTerm=$(this).val(); updateSearchInput(); });
  $('#m-search-input').on('input',function(){ searchTerm=$(this).val(); setTimeout(function(){ navigate(ViewState.HOME); },0); });
}
```

分点4：导航交互统一绑定于 `bindNav()`，通过读取 `data-view` 与可选的 `data-anchor` 实现跨页面跳转与定位；“开始探索”按钮滚动至活动区，形成从横幅到内容的自然引导，降低首屏的跳出与迷航概率。

代码位置：`assets/app.js:329–358`

```javascript
function bindNav(){
  $('.nav-item').off().on('click',function(){ var v=$(this).data('view'); var anchor=$(this).data('anchor'); if(anchor==='activities'){ navigate(ViewState.HOME,{anchor:'activities'}); } else { navigate(v); }});
  $('#footer-feedback').off().on('click',function(){ navigate(ViewState.FEEDBACK); });
  $('#mobile-menu-btn').off().on('click',function(){ $('#mobile-menu').toggleClass('d-none'); });
  $('#btn-explore').off().on('click',function(){ var el=document.getElementById('activities'); if(el){ el.scrollIntoView({behavior:'smooth'}); } });
}
```

### 2.3 活动详情（detail.html）

结构是如何实现的：

分点1：详情页顶部视觉区通过 `detail-hero` 与渐变叠层构建，背景图覆盖全宽高，并在左上角悬浮一个“返回列表”按钮。底部 `detail-bottom` 承载类别徽章、主标题与时间地点信息，使核心信息在第一屏即被准确传达。

代码位置：结构容器 `detail.html:55–57`，渲染 `assets/app.js:546–569`

```javascript
var wrap=$('#detail-container'); wrap.empty();
var hero=$('<div class="detail-hero"></div>');
hero.append('<img src="'+ev.imageUrl+'" class="hero-bg">');
hero.append('<div class="detail-overlay"></div>');
var back=$('<button class="btn btn-light btn-pill" style="position:absolute;top:2rem;left:2rem">返回列表</button>');
back.on('click',function(){ navigate(ViewState.HOME); });
var bottom=$('<div class="detail-bottom"></div>');
bottom.append('<div class="container"><span class="badge bg-primary">'+ev.category+'</span><h1 class="text-white fw-bold">'+ev.title+'</h1><div class="d-flex gap-3 text-white-50 fw-medium"><span>'+new Date(ev.date).toLocaleString()+'</span><span>'+ev.location+'</span></div></div>');
hero.append(back); hero.append(bottom); wrap.append(hero);
```

分点2：主体内容区分为“活动介绍”与“图集预览”两部分。介绍以可读性优先的段落形式呈现，图集则按两列排列并限定高度，确保在常见屏幕上获得良好的浏览节奏，避免内容密度变化导致的跳跃。

代码位置：`assets/app.js:570–587`

```javascript
var main=$('<div class="container py-4"></div>');
var row=$('<div class="row g-4"></div>');
var colMain=$('<div class="col-lg-8"></div>');
var intro=$('<div></div>'); intro.append('<h4 class="fw-bold mb-3">活动介绍</h4>'); intro.append('<p class="text-secondary">'+ev.description+'</p>');
var gallery=$('<div class="row g-3 mt-2"></div>');
gallery.append('<div class="col-6"><img src="assets/img/gallery-1-'+ev.id+'.jpg" class="rounded-2xl" style="width:100%;height:12rem;object-fit:cover"></div>');
gallery.append('<div class="col-6"><img src="assets/img/gallery-2-'+ev.id+'.jpg" class="rounded-2xl" style="width:100%;height:12rem;object-fit:cover"></div>');
intro.append(gallery); colMain.append(intro);
```

分点3：讨论区与评论表单在登录状态下动态启用。若有评论则以头像+气泡的列表样式逐条呈现；未登录则提示登录以参与互动。表单提交后将新评论写入当前活动并刷新视图，形成闭环的阅读与发表体验。

代码位置：`assets/app.js:588–649`

```javascript
var comments=$('<div class="mt-4"></div>'); comments.append('<h4 class="fw-bold mb-3">讨论区</h4>');
if(ev.comments.length===0){ comments.append('<div class="text-center py-4 bg-light rounded-2xl">暂无评论，快来抢沙发！</div>'); }
else{ /* 遍历并渲染评论列表 */ }
var form=$('<div class="mt-3"></div>');
if(currentUser){ var ta=$('<textarea class="form-control rounded-3" rows="3" placeholder="发表你的看法..."></textarea>'); var btn=$('<button class="btn btn-dark btn-pill mt-2">发送</button>'); btn.on('click',function(){ /* 追加评论与保存 */ }); form.append(ta).append(btn); }
else{ form.append('<div class="alert alert-primary">请登录后参与评论</div>'); }
comments.append(form); colMain.append(comments);
```

分点4：右侧信息卡片采用 `position:sticky` 固定在视窗顶部下方，包含“距离开始倒计时”、“主办方与热度”、“报名进度条”，以及报名、收藏、分享与 ICS 导出动作区域，确保在阅读过程中可随时触达关键操作。

代码位置：`assets/app.js:650–667,668–836`

```javascript
var colSide=$('<div class="col-lg-4"></div>');
var card=$('<div class="p-4 rounded-4 shadow-soft border" style="position:sticky;top:2rem"></div>');
/* 倒计时与主办方、热度、进度条 */
var regBtn=$('<button class="btn btn-pill w-100 mb-2">...</button>');
var favBtn=$('<button class="btn btn-outline-danger btn-pill w-50 me-2">收藏</button>');
var shareBtn=$('<button class="btn btn-outline-secondary btn-pill w-50">分享</button>');
var icsBtn=$('<button class="btn btn-link w-100">添加到日历 (ICS)</button>');
card.append(regBtn); card.append($('<div class="d-flex"></div>').append(favBtn).append(shareBtn)); card.append(icsBtn);
colSide.append(card); row.append(colMain).append(colSide); main.append(row); wrap.append(main);
```

样式是如何实现的：

分点1：`detail-hero` 控制视觉区高度与溢出，`detail-overlay` 自底向上渐变提升文字对比度，`detail-bottom` 以绝对定位增强信息与背景的空间分离，保证在不同海报素材下的可读性与一致性。

代码位置：`assets/styles.css:274–296`

```css
.detail-hero{position:relative;height:50vh;overflow:hidden;background:#000}
.detail-overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.8),transparent,rgba(0,0,0,.3))}
.detail-bottom{position:absolute;bottom:0;left:0;right:0;padding:1.5rem}
```

分点2：按钮与进度样式沿用统一的胶囊与品牌配色。`btn-pill` 统一圆角半径，`progress-wrap` 与 `progress-bar-apple` 组合呈现报名比例，配合柔和阴影 `shadow-soft` 与半透明玻璃背景 `glass` 增强视觉层次。

代码位置：`assets/styles.css:297–313,331–333,298–300`

```css
.glass{background:rgba(255,255,255,.08);backdrop-filter:blur(8px)}
.btn-pill{border-radius:999px}
.progress-wrap{height:12px;background:#eee;border-radius:999px;overflow:hidden}
.progress-bar-apple{background:#0071e3;height:100%}
.shadow-soft{box-shadow:0 8px 30px rgba(0,0,0,.08)}
```

分点3：分享弹层与入场动画样式使用半透明遮罩与轻动效。`modal-dark` 提升对话框聚焦，`animate-fade-in` 与 `@keyframes fadeIn` 提供从下至上的渐现过渡，使交互反馈更自然而不突兀。

代码位置：`assets/styles.css:314–330`

```css
.modal-dark{background:rgba(0,0,0,.6);backdrop-filter:blur(4px)}
.animate-fade-in{animation:fadeIn .5s ease-out forwards}
@keyframes fadeIn{0%{opacity:0;transform:translateY(10px)}100%{opacity:1;transform:translateY(0)}}
```

功能是如何实现的：

分点1：URL 参数解析在无预选事件时执行，从查询字符串中取 `id` 并匹配到活动数组，找不到则回退首页。该逻辑保证详情页可从不同入口进入且状态一致，避免因刷新导致的数据丢失。

代码位置：`assets/app.js:531–545`

```javascript
if(!selectedEvent){ var q=window.location.search; var m=/[?&]id=([^&]+)/.exec(q); if(m&&m[1]){ var id=decodeURIComponent(m[1]); selectedEvent=events.find(function(e){ return e.id===id; }); } }
if(!selectedEvent){ navigate(ViewState.HOME); return; }
```

分点2：报名切换依据当前用户是否存在于 `registeredUsers` 数组，点击后在本地事件列表中增删用户并同步人数，再调用 `saveEvents()` 持久化并重新渲染，形成可逆的即时交互反馈。

代码位置：`assets/app.js:688–723`

```javascript
regBtn.on('click',function(){ if(!currentUser){ alert('请先登录'); return; } events=events.map(function(e){ if(e.id===ev.id){ var idx=e.registeredUsers.indexOf(currentUser.id); if(idx>-1){ e.registeredUsers=e.registeredUsers.filter(function(i){ return i!==currentUser.id; }); e.attendees=Math.max(0,e.attendees-1); } else { e.registeredUsers=e.registeredUsers.concat([currentUser.id]); e.attendees=e.attendees+1; } } return e; }); selectedEvent=events.find(function(e){ return e.id===ev.id; }); saveEvents(); renderDetail(); });
```

分点3：收藏切换与报名逻辑一致，但仅维护 `favoritedUsers` 集合，不改变参与人数。状态变化后同样持久化与刷新界面，保证收藏标识与动作按钮文案同步更新。

代码位置：`assets/app.js:724–755`

```javascript
favBtn.on('click',function(){ if(!currentUser){ alert('请先登录'); return; } events=events.map(function(e){ if(e.id===ev.id){ var idx=e.favoritedUsers.indexOf(currentUser.id); if(idx>-1){ e.favoritedUsers=e.favoritedUsers.filter(function(i){ return i!==currentUser.id; }); } else { e.favoritedUsers=e.favoritedUsers.concat([currentUser.id]); } } return e; }); selectedEvent=events.find(function(e){ return e.id===ev.id; }); saveEvents(); renderDetail(); });
```

分点4：分享逻辑优先调用 `navigator.share`，在不支持环境下退化为自建弹层，内含链接复制与扫码提示。采用最小依赖与渐进增强策略，保证不同浏览器上的一致可用性。

代码位置：`assets/app.js:756–796`

```javascript
shareBtn.on('click',function(){ var url=window.location.href; if(navigator.share){ navigator.share({ title:ev.title, text:ev.description, url:url }).catch(function(){}); } else { /* 构建模态层与复制按钮 */ } });
```

分点5：ICS 导出严格遵循 iCalendar 规范，时间戳格式统一去除分隔与毫秒并补齐 `Z`。通过 `Blob` 生成文件并使用隐式锚点触发下载，整个流程在前端完全完成，便于离线查看与跨平台导入。

代码位置：`assets/app.js:797–836`

```javascript
var ics='BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//CampusHub//Event//CN\nBEGIN:VEVENT\nUID:'+ev.id+'@campushub.com\nDTSTAMP:'+fmt(new Date())+'\nDTSTART:'+fmt(start)+'\nDTEND:'+fmt(end)+'\nSUMMARY:'+ev.title+'\nDESCRIPTION:'+ev.description+'\nLOCATION:'+ev.location+'\nEND:VEVENT\nEND:VCALENDAR';
var blob=new Blob([ics],{ type:'text/calendar;charset=utf-8' }); var url=URL.createObjectURL(blob); var a=document.createElement('a'); a.href=url; a.download=ev.title+'.ics'; document.body.appendChild(a); a.click(); document.body.removeChild(a);
```

### 2.4 发布活动（publish.html）

结构是如何实现的：

分点1：页面采用左右分栏布局，左侧为半屏视觉区展示主题图与引导语，右侧为表单区域容器。视觉区包含顶部返回按钮与底部深色渐变，增强层次感与可读性，同时在大屏上提供仪式感的发布体验。

代码位置：`publish.html:57–70`

```html
<div class="d-flex">
  <div class="d-none d-lg-block visual-left">
    <img src="assets/img/publish-bg.jpg" class="visual-img" alt="" />
    <div class="visual-overlay"></div>
    <div class="visual-top container py-3"><button class="apple-back" id="publish-back">← 返回首页</button></div>
    <div class="visual-content container"><h2 class="text-light fw-bold display-6 mb-3">让创意落地，<br/>只需简单几步。</h2></div>
  </div>
  <div class="flex-grow-1"><div class="container py-4 py-md-5" id="publish-form-wrap"></div></div>
</div>
```

分点2：表单由标题、时间、地点、类型、人数、详情与主办方等字段组成，按两行网格分布，既保证信息完整性，又减少纵向滚动。底部行为区提供“取消/立即发布”，将主要动作置于固定分割线之后，符合表单提交的视觉预期。

代码位置：`assets/app.js:842–883`

```javascript
var form=$('<form class="mt-3"></form>');
form.append('<label class="form-label fw-bold">活动标题</label><input required type="text" name="title" class="form-control form-control-lg rounded-3 mb-3" placeholder="例如：2025 秋季校园黑客松">');
var grid=$('<div class="row g-3"></div>');
grid.append('<div class="col-md-6"><label class="form-label fw-bold">时间</label><input required type="datetime-local" name="date" class="form-control rounded-3"></div>');
grid.append('<div class="col-md-6"><label class="form-label fw-bold">地点</label><input required type="text" name="location" class="form-control rounded-3" placeholder="例如：科技楼 A101"></div>');
var grid2=$('<div class="row g-3 mt-1"></div>');
grid2.append('<div class="col-md-6"><label class="form-label fw-bold">活动类型</label><select name="category" class="form-select rounded-3"><option value="academic">学术讲座</option><option value="sports">体育赛事</option><option value="arts">文艺演出</option><option value="social">社交聚会</option></select></div>');
grid2.append('<div class="col-md-6"><label class="form-label fw-bold">最大人数</label><input required type="number" name="maxAttendees" class="form-control rounded-3" value="50"></div>');
var descWrap=$('<div class="mt-2"></div>'); descWrap.append('<label class="form-label fw-bold mb-0">活动详情</label>'); descWrap.append('<textarea required name="description" rows="8" class="form-control rounded-3" placeholder="请描述活动的具体流程、嘉宾介绍及参与须知..."></textarea>');
var org=$('<div class="mt-2"></div>'); org.append('<label class="form-label fw-bold">主办方</label><input required type="text" name="organizer" class="form-control rounded-3" placeholder="例如：校学生会">');
var actions=$('<div class="pt-3 border-top d-flex gap-2"></div>');
actions.append('<button type="button" class="btn btn-light rounded-pill">取消</button>').append('<button type="submit" class="btn btn-primary rounded-pill flex-grow-1">立即发布</button>');
form.append(grid).append(grid2).append(descWrap).append(org).append(actions);
```

分点3：返回按钮与占位修正作为细节完善。点击返回回到首页，输入框占位文本根据年份自动修正，避免历史拷贝造成的语义不一致，体现对微交互与文案一致性的关注。

代码位置：返回 `assets/app.js:884–888`，占位修正 `assets/app.js:1575–1579`

```javascript
$('#publish-back').off().on('click',function(){ setView(ViewState.HOME); });
var input=$('#publish-form-wrap input[name=title]'); if(input.length){ input.attr('placeholder','例如：2025 秋季校园黑客松'); }
```

样式是如何实现的：

分点1：半屏视觉区以 `visual-left` 控制宽度与高度，背景图 `visual-img` 使用半透明提高文字对比，叠层 `visual-overlay` 提供从浅至深的渐变，结合顶部 `visual-top` 与居中 `visual-content` 构成稳定的信息布局。

代码位置：`assets/styles.css:155–186,169–178,179–194`

```css
.visual-left{position:relative;width:42%;background:#000;min-height:100vh}
.visual-img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:.5}
.visual-overlay{position:absolute;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,.4),transparent,rgba(0,0,0,.9))}
.visual-top{position:absolute;top:0;left:0;right:0;z-index:2}
.visual-content{position:relative;z-index:2;min-height:100vh;display:flex;align-items:center;justify-content:center}
```

分点2：返回按钮采用玻璃拟态与胶囊形态，悬停与按下均有细微位移与背景变化反馈。该控件在多个页面复用，构成一致的返回行为与视觉语言，降低跨模块学习成本。

代码位置：`assets/styles.css:365–381`

```css
.apple-back{display:inline-flex;align-items:center;gap:.5rem;color:#fff;background:rgba(255,255,255,.12);backdrop-filter:blur(8px);border:none;padding:.5rem .9rem;border-radius:999px;font-weight:700;box-shadow:0 8px 30px rgba(0,0,0,.08);transition:transform .15s ease,background .15s ease}
.apple-back:hover{background:rgba(255,255,255,.18);transform:translateY(-1px)}
.apple-back:active{transform:translateY(0)}
```

功能是如何实现的：

分点1：`renderPublish()` 以声明式方式构建表单 DOM，统一在容器中追加并绑定。字段值在提交时集中采集生成活动对象，随后插入事件数组头部，保证新活动优先展示以提升反馈感知。

代码位置：`assets/app.js:842–919`

```javascript
form.on('submit',function(e){ e.preventDefault(); var fd={ /* 采集字段 */ }; var newEvent={ id:Date.now()+'', title:fd.title, description:fd.description, date:fd.date, location:fd.location, category:fd.category, imageUrl:'assets/img/event-'+(Math.floor(Math.random()*12)+1)+'.jpg', organizer:fd.organizer, attendees:0, maxAttendees:fd.maxAttendees, comments:[], registeredUsers:[], favoritedUsers:[] }; events=[newEvent].concat(events); setView(ViewState.HOME); });
```

### 2.5 统计分析（stats.html）

结构是如何实现的：

分点1：页面顶部为标题与说明，然后以指标卡片概览全局指标；下方四象限布局承载饼图、折线图、柱状图与雷达图，采用响应式栅格保证在不同屏幕宽度下的排列与换行一致。

代码位置：`stats.html:56–61,62–185`

```html
<div class="row g-4" id="metric-cards"></div>
<div class="row g-4 mt-2">
  <div class="col-lg-6"><div class="card shadow-sm rounded-4"><div class="card-body"><div class="d-flex justify-content之间 align-items-center mb-2"><h5 class="fw-bold">活动类型分布 (ECharts)</h5></div><div id="echarts-pie" style="height:320px"></div></div></div></div>
  <div class="col-lg-6"><div class="card shadow-sm rounded-4"><div class="card-body"><h5 class="fw-bold mb-2">月度参与趋势</h5><div id="echarts-line" style="height:320px"></div></div></div></div>
  <div class="col-lg-6"><div class="card shadow-sm rounded-4"><div class="card-body"><h5 class="fw-bold mb-2">热门活动 Top 5</h5><div id="echarts-bar" style="height:320px"></div></div></div></div>
  <div class="col-lg-6"><div class="card shadow-sm rounded-4"><div class="card-body"><h5 class="fw-bold mb-2">校园活力维度</h5><div id="echarts-radar" style="height:320px"></div></div></div></div>
</div>
```

分点2：指标卡片由四类关键值组成，分别反映活动总量、参与总数、热门类型与本月新增。卡片采用白底圆角与轻阴影风格，数值与标题的层级对比明显，提升浏览与比较效率。

代码位置：`assets/app.js:920–962`

```javascript
var container=$('#metric-cards'); container.empty();
var totalAtt=events.reduce(function(a,c){ return a+c.attendees; },0);
var cards=[{ title:'活动总量', value:events.length, accent:'primary' },{ title:'总参与', value:totalAtt, accent:'success' },{ title:'热门类型', value:mostCat(), accent:'purple' },{ title:'本月新增', value:'+8', accent:'warning' }];
cards.forEach(function(c){ var col=$('<div class="col-12 col-md-6 col-lg-3"></div>'); var card=$('<div class="bg-white p-4 rounded-4 shadow-sm h-100"></div>'); card.append('<div class="text-secondary text-uppercase fw-bold" style="font-size:12px">'+c.title+'</div>'); card.append('<div class="fs-3 fw-bold">'+c.value+'</div>'); col.append(card); container.append(col); });
```

分点3：四类图表的数据源均由前端聚合生成。饼图展示类型占比，折线图反映月度趋势，柱状图列出热门活动 Top 5，雷达图用于维度综合评分；全部使用 ECharts 初始化并设置颜色、平滑与图例样式。

代码位置：`assets/app.js:963–1009,1010–1041,1042–1064`

```javascript
var pie=echarts.init(document.getElementById('echarts-pie')); pie.setOption({ series:[{ type:'pie', radius:['40%','70%'], label:{ show:false }, labelLine:{ show:false }, data:pieData, color:['#0071e3','#34c759','#ff9500','#af52de'] }] });
var line=echarts.init(document.getElementById('echarts-line')); line.setOption({ xAxis:{ type:'category', data:['9月','10月','11月','12月','1月'] }, yAxis:{ type:'value' }, series:[{ type:'line', data:[120,280,450,520,180], smooth:true, lineStyle:{ width:3, color:'#0071e3' }, itemStyle:{ color:'#0071e3' } }] });
var bar=echarts.init(document.getElementById('echarts-bar')); bar.setOption({ xAxis:{ type:'category', data:barData.map(function(d){ return d.name; }) }, yAxis:{ type:'value' }, series:[{ type:'bar', data:barData.map(function(d){ return d.value; }), itemStyle:{ color:'#34c759' } }] });
var radar=echarts.init(document.getElementById('echarts-radar')); radar.setOption({ radar:{ indicator:[{ name:'学术',max:150 },{ name:'艺术',max:150 },{ name:'体育',max:150 },{ name:'社交',max:150 },{ name:'公益',max:150 },{ name:'创新',max:150 }] }, series:[{ type:'radar', data:[{ value:[120,98,86,99,85,65], name:'活力指数' }], itemStyle:{ color:'#ff9500' }, lineStyle:{ color:'#ff9500' }, areaStyle:{ color:'rgba(255,149,0,.3)' } }] });
```

样式是如何实现的：

分点1：图表容器置于卡片内，卡片采用 `rounded-4` 与 `shadow-sm`，在浅灰背景上形成清晰的视觉分组，便于在同一视图内进行横向与纵向的比较阅读。

代码位置：示例参见 `stats.html:62–185` 与 `assets/styles.css:331–333`

```css
.shadow-soft{box-shadow:0 8px 30px rgba(0,0,0,.08)}
```

分点2：指标卡片与图表区通过统一的间距体系 `g-4` 与 `mt-2` 保持模块间的秩序感，使信息密度与呼吸空间达到平衡，提升整体版面可读性与节奏。

功能是如何实现的：

分点1：窗口大小变化时监听 `resize` 并调用各图表的 `resize()`，确保在设备旋转或窗口拖拽时图表自适配，不出现溢出或压缩失真的情况。

代码位置：`assets/app.js:1065–1071`

```javascript
window.addEventListener('resize',function(){ pie.resize(); line.resize(); bar.resize(); radar.resize(); });
```

### 2.6 活动日历（calendar.html）

结构是如何实现的：

分点1：日历头部包含标题说明与左右切换按钮，中间的月份标题随当前上下文更新。按钮置于圆角胶囊容器中，与整体风格一致，同时承载交互语义，形成明晰的时序导航。

代码位置：`assets/app.js:1493–1506`

```javascript
var header=$('<div class="d-flex justify-content之间 align-items-center mb-3"></div>');
var nav=$('<div class="d-flex align-items-center gap-2 bg-white rounded-pill px-3 py-2 border"></div>');
var prev=$('<button class="btn btn-light btn-pill">‹</button>');
var title=$('<div class="fw-bold">'+y+'年 '+(m+1)+'月</div>');
var next=$('<button class="btn btn-light btn-pill">›</button>');
nav.append(prev).append(title).append(next); header.append(nav); wrap.append(header);
```

分点2：星期标题行与日历主体均使用 `calendar-grid` 以 7 列网格呈现。主体在首行填充空格以对齐首日位置，然后为每个日期渲染单元格与事件列表，确保结构语义与视觉对齐准确。

代码位置：`assets.app.js:1516–1524,1525–1531`

```javascript
var daysHeader=$('<div class="calendar-grid border-bottom bg-light"></div>');
['日','一','二','三','四','五','六'].forEach(function(d){ daysHeader.append('<div class="py-2 text-center text-secondary fw-bold">'+d+'</div>'); });
var body=$('<div class="calendar-grid" style="height:70vh"></div>');
var firstDay=new Date(y,m,1).getDay(); for(var i=0;i<firstDay;i++){ body.append('<div class="calendar-cell bg-light"></div>'); }
```

分点3：日期单元格渲染时高亮今日，并在下方渲染当日所有事件，点击事件项直接联动到详情页。通过阻止事件冒泡避免触发父级单元的其他点击行为，保证交互的明确与可控。

代码位置：`assets/app.js:1531–1574`

```javascript
for(var d=1; d<=daysInMonth; d++){
  var cell=$('<div class="calendar-cell"></div>');
  var today=new Date(); var isToday=d===today.getDate()&&m===today.getMonth()&&y===today.getFullYear();
  cell.append('<div class="d-flex justify-content之间"><div class="calendar-day '+(isToday?'bg-primary text-white':'')+'">'+d+'</div></div>');
  var list=$('<div></div>');
  var dayEvents=events.filter(function(e){ var de=new Date(e.date); return de.getDate()===d&&de.getMonth()===m&&de.getFullYear()===y; });
  dayEvents.forEach(function(ev){ var item=$('<div class="calendar-event"></div>'); item.append('<div class="fw-bold" style="font-size:12px">'+ev.title+'</div>'); item.append('<div class="text-secondary" style="font-size:10px">'+new Date(ev.date).getHours()+':00</div>'); item.on('click',function(e){ e.stopPropagation(); selectedEvent=ev; setView(ViewState.DETAIL); }); list.append(item); });
  cell.append(list); body.append(cell);
}
```

样式是如何实现的：

分点1：网格与单元格的边界与内边距统一定义，保证日历在大多数屏幕下的清晰划分。日期圆点采用粗体与居中显示，事件条目为小号文字、细边框与轻圆角，方便密集列表的阅读。

代码位置：`assets/styles.css:337–364`

```css
.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr)}
.calendar-cell{border-right:1px solid #eee;border-bottom:1px solid #eee;padding:.5rem;min-height:100px}
.calendar-day{width:32px;height:32px;border-radius:999px;display:flex;align-items:center;justify-content:center;font-weight:700}
.calendar-event{border:1px solid #eee;background:#fff;border-radius:12px;padding:.25rem .4rem;font-size:.75rem;margin:.25rem 0;cursor:pointer}
```

功能是如何实现的：

分点1：月份切换通过维护 `__calDate` 并在点击前后更新，再递归调用 `renderCalendar()` 完成重绘。该方式无需复杂状态管理即可实现时间轴的顺滑导航与视图刷新。

代码位置：`assets/app.js:1507–1514`

```javascript
prev.on('click',function(){ window.__calDate=new Date(y,m-1,1); renderCalendar(); });
next.on('click',function(){ window.__calDate=new Date(y,m+1,1); renderCalendar(); });
```

### 2.7 登录（login.html）

结构是如何实现的：

分点1：页面采用左右布局，左侧为半屏视觉，右侧为垂直居中的表单容器。视觉区提供品牌叙事与引导文案，表单区则保证在多数设备上均能无滚动完成输入与提交，提升完成率与舒适度。

代码位置：`login.html:56–67`

```html
<div class="d-flex min-vh-100">
  <div class="d-none d-lg-block half-visual">
    <img src="assets/img/login-bg.jpg" class="visual-img" alt="" />
    <div class="visual-gradient"></div>
    <div class="visual-caption container"><h2 class="display-5 text-light fw-bold mb-3">探索无限可能。</h2><p class="lead text-light-50">CampusHub 是连接你与校园精彩活动的桥梁。立即登录，开启你的专属旅程。</p></div>
  </div>
  <div class="flex-grow-1 d-flex align-items-center"><div class="container" id="login-form-wrap"></div></div>
</div>
```

样式是如何实现的：

分点1：半屏视觉区使用 `half-visual` 控制宽度，底部 `visual-gradient` 形成自下而上的黑色渐层，`visual-caption` 将内容垂直居中，配合浅色文本与半透明说明，获得兼顾情感与可读性的效果。

代码位置：`assets/styles.css:208–228`

```css
.half-visual{position:relative;width:50%;background:#111;min-height:100vh}
.visual-gradient{position:absolute;bottom:0;left:0;right:0;background:linear-gradient(to top,rgba(0,0,0,.9),transparent);height:50%}
.visual-caption{position:absolute;top:50%;left:0;right:0;transform:translateY(-50%)}
```

功能是如何实现的：

分点1：`renderLogin()` 构建登录表单并绑定提交，将模拟用户信息写入内存，随后跳转首页并刷新导航区认证态。该逻辑示范了在无后端条件下的前端认证流程与页面联动。

代码位置：`assets/app.js:1072–1110`

```javascript
form.on('submit',function(e){ e.preventDefault(); currentUser={ id:'user_123', name:'梁升富', email:'LiangShengFu_2023152006@university.edu', avatar:'assets/img/avatar.jpg', role:'student' }; setView(ViewState.HOME); renderAuth(); });
```

### 2.8 注册（register.html）

结构是如何实现的：

分点1：注册页结构与登录页保持对称，沿用半屏视觉+居中表单的布局。表单包含姓名、学号、校园邮箱与密码四项核心字段，并通过网格保持两列排布，便于快速填写与校对。

代码位置：`register.html:56–67`

```html
<div class="d-flex min-vh-100">
  <div class="d-none d-lg-block half-visual">
    <img src="assets/img/register-bg.jpg" class="visual-img" alt="" />
    <div class="visual-gradient"></div>
    <div class="visual-caption container"><h2 class="display-5 text-light fw-bold mb-3">加入社区。</h2><p class="lead text-light-50">创建您的 CampusHub 账户，立即开始组织、参与和分享精彩的校园活动。</p></div>
  </div>
  <div class="flex-grow-1 d-flex align-items-center"><div class="container" id="register-form-wrap"></div></div>
</div>
```

样式是如何实现的：

分点1：复用登录页视觉样式，保持两个入口的一致性与连贯感。通过统一的字号、间距与色彩，降低用户在不同入口之间的认知负担。

功能是如何实现的：

分点1：`renderRegister()` 构建注册表单并绑定提交，模拟生成用户，随后返回首页并刷新认证区。该实现以最小可行交互完成新用户加入流程，并与后续个人中心能力对接。

代码位置：`assets/app.js:1111–1156`

```javascript
form.on('submit',function(e){ e.preventDefault(); currentUser={ id:'user_123', name:'梁升富', email:'LiangShengFu_2023152006@university.edu', avatar:'assets/img/avatar.jpg', role:'student' }; setView(ViewState.HOME); renderAuth(); });
```

### 2.9 个人中心（profile.html）

结构是如何实现的：

分点1：顶部封面与信息头采用覆盖式布局，头像以圆形边框强调个人身份，右侧为姓名、账号与学院信息，以及行为按钮（编辑、分享、退出），构成个人信息的集中展示与管理入口。

代码位置：`assets/app.js:1158–1214`

```javascript
var cover=$('<div class="position-relative" style="height:260px;overflow:hidden"></div>'); cover.append('<img src="assets/img/hero-bg.jpg" style="width:100%;height:100%;object-fit:cover">'); cover.append('<div class="position-absolute" style="inset:0;background:linear-gradient(to top,rgba(0,0,0,.6),transparent)"></div>');
var info=$('<div class="container position-relative" style="margin-top:-64px"></div>');
var row=$('<div class="d-flex align-items-end gap-3"></div>');
row.append('<img src="'+currentUser.avatar+'" class="rounded-circle border" style="width:120px;height:120px;border:6px solid #fff">');
```

分点2：统计条以“参与活动/收藏活动/社区声望”为三项指标，居左排列并使用数值+小标题组合，形成快速的行为概览。下方标签页以四个按钮切换不同内容容器，采用边框底线与置顶间距构建清晰的信息层级。

代码位置：`assets/app.js:1215–1245,1230–1245`

```javascript
var statWrap=$('<div class="container border-bottom py-3 mb-3"></div>');
statWrap.append('<div class="d-flex gap-4"><div><div class="fs-4 fw-bold">'+myEvents.length+'</div><div class="text-secondary small">参与活动</div></div><div><div class="fs-4 fw-bold">'+myFavs.length+'</div><div class="text-secondary small">收藏活动</div></div><div><div class="fs-4 fw-bold">980</div><div class="text-secondary small">社区声望</div></div></div>');
var tabs=$('<div class="container d-flex gap-4 border-bottom"></div>'); var t1=$('<button class="btn btn-link fw-bold">我的活动 ('+myEvents.length+')</button>'); var t2=$('<button class="btn btn-link fw-bold">收藏 ('+myFavs.length+')</button>'); var t3=$('<button class="btn btn-link fw-bold">动态与评论</button>'); var t4=$('<button class="btn btn-link fw-bold">荣誉徽章</button>');
```

样式是如何实现的：

分点1：个人页标题与弱文本在 `#profile-wrap` 下进行覆盖式强化，使用更高的字重与尺寸，保证在浅色背景下的稳定可读性，形成与其他页面的视觉差异化。

代码位置：`assets/styles.css:390–416`

```css
.profile-name{color:#111;font-size:2.2rem;letter-spacing:-.01em}
.profile-handle{color:#333;font-weight:600}
#profile-wrap h2.fw-bold{color:#000 !important;font-size:2.4rem;letter-spacing:-.01em}
#profile-wrap .text-muted{color:#000 !important;font-weight:700}
```

功能是如何实现的：

分点1：四个标签页分别渲染“我的活动”“我的收藏”“动态与评论”“荣誉徽章”。列表均复用卡片组件，点击卡片进入详情；动态与评论使用轻卡片流式排列；徽章以网格卡片展示，包含图标、名称与描述。

代码位置：`assets/app.js:1247–1376`

```javascript
t1.on('click',showAct); t2.on('click',showFav); t3.on('click',showMoments); t4.on('click',showBadges); showAct();
```

### 2.10 意见反馈（feedback.html）

结构是如何实现的：

分点1：反馈页以居中的卡片容器承载表单，卡片周围留出充足留白与外阴影，形成轻盈且聚焦的视觉。卡片内部采用段落化分组，先选择反馈类型、再填写标题与详细描述，最后附联系方式与提交按钮。

代码位置：结构容器 `feedback.html:56–60`

```html
<div class="row g-4 justify-content之间"><div class="col-lg-8 mx-auto"><div id="feedback-form-wrap"></div></div></div>
```

样式是如何实现的：

分点1：分段选择器以 `seg-item/seg-card` 实现点击态与选中态，轻边框与浅灰背景提升触感反馈；输入框与文本域采用软糖风格 `input-soft/textarea-soft`，获得温和的视觉表达并降低认知负担；提交按钮 `btn-apple` 使用品牌蓝色强化主行动。

代码位置：`assets/styles.css:418–492`

```css
.seg-item{position:relative;display:block}
.seg-input{position:absolute;opacity:0;pointer-events:none}
.seg-card{padding:.75rem 1rem;border:1px solid #e5e7eb;border-radius:12px;background:#f9fafb;text-align:center;font-size:.9rem;font-weight:600;color:#6b7280;transition:all .15s}
.seg-item .seg-input:checked + .seg-card{background:#000;color:#fff;border-color:#000}
.input-soft,.textarea-soft{width:100%;padding:1rem;border-radius:12px;background:#f5f5f7;border:1px solid transparent;transition:all .15s;color:#111}
.btn-apple{background:#0071e3;color:#fff;border:none}
```

功能是如何实现的：

分点1：`renderFeedback()` 构建类型选择的 2×2 网格，并为首项设置默认选中；随后依次渲染标题、详细描述与联系方式输入，再在底部追加宽幅主按钮与处理提示。表单提交按钮目前以前端模拟为主，便于后续接入后端。

代码位置：`assets/app.js:1445–1485`

```javascript
var types=['功能建议','Bug 报告','活动投诉','其他']; var group=$('<div class="row g-2"></div>'); types.forEach(function(t,i){ var col=$('<div class="col-6 col-md-3"></div>'); var label=$('<label class="seg-item w-100"></label>'); var input=$('<input type="radio" name="fb-type" class="seg-input" value="'+t+'">'); if(i===0){ input.attr('checked',true); } var seg=$('<div class="seg-card">'+t+'</div>'); label.append(input).append(seg); col.append(label); group.append(col); });
form.append('<label class="form-label fw-semibold">标题</label><input type="text" class="input-soft mb-3" placeholder="简要描述您的问题">');
form.append('<label class="form-label fw-semibold">详细描述</label><textarea rows="6" class="textarea-soft mb-3" placeholder="请详细描述您遇到的情况或建议..."></textarea>');
form.append('<label class="form-label fw-semibold">联系方式 <span class="text-secondary">(选填)</span></label><input type="text" class="input-soft mb-4" placeholder="邮箱或电话，方便我们联系您">');
form.append('<button class="w-100 py-3 btn btn-apple btn-pill shadow-soft">提交反馈</button><div class="text-center text-secondary small mt-2">我们通常会在 24 小时内阅读并处理您的反馈。</div>');
```

## 3．项目总结

本次课程项目从零到一构建了一个功能相对完备的校园活动管理平台。整个过程不仅是对课堂所学Web开发知识的一次全面检验和实践，更是一次关于产品设计、用户体验和工程思维的深度探索。

在项目架构上，我们选择了一条务实的路线。在没有引入重型前端框架的前提下，通过原生JavaScript和 `localStorage` 构建了一套轻量级的状态管理和导航机制，成功地在多页面应用中模拟出了单页面应用的流畅体验。这种设计虽然在复杂性上有所妥协，但换来了极低的上手门槛和高度的灵活性，证明了即使是基础技术，只要巧妙组合，也能构建出交互完善的现代化应用。

**项目挑战与解决方案**：
*   **挑战一：跨页面的状态一致性**。这是本次项目的核心难题。我们最终通过设计统一的 `navigate` 函数，强制在每次页面跳转前执行 `saveState` 操作，形成了一个“修改-保存-跳转”的原子操作流程，有效地保证了数据在不同视图间的同步。
*   **挑战二：响应式布局的精细化调试**。虽然Bootstrap提供了强大的栅格系统，但在处理特定组件（如导航栏、复杂的表单）在不同屏幕尺寸下的表现时，仍需编写大量的媒体查询（Media Queries）进行微调。我们通过反复在浏览器开发者工具中模拟不同设备，才最终打磨出较为理想的跨端体验。
*   **挑战三：前端性能优化**。在首页活动数量增多时，初版的渲染函数会导致页面卡顿。我们通过在渲染前进行数据过滤，以及未来可以引入的“虚拟列表”或“分页加载”等技术，来优化DOM操作的性能。

**心得体会与未来展望**：
通过这个项目，我深刻体会到“用户为中心”的设计思想是多么重要。一个功能的价值，不仅在于它能否实现，更在于它是否易用、好用。从搜索建议到ICS导出，这些看似微小的细节，恰恰是提升用户体验的关键。同时，我也认识到代码的模块化和规范化是项目能够持续迭代的基石。将不同页面的渲染逻辑封装在各自的 `render` 函数中，并由一个总的 `init` 函数统一调度，使得整个代码库结构清晰，易于维护。

展望未来，这个项目还有巨大的提升空间：
1.  **后端整合**：目前的数据存储在 `localStorage`，这只是一个前端模拟。下一步最关键的升级就是引入真正的后端服务（如 Node.js + Express）和数据库（如 MongoDB 或 MySQL），实现用户注册、活动数据的持久化存储和更复杂的权限管理。
2.  **实时交互**：引入 WebSocket 技术，可以实现活动评论的实时更新、报名人数的实时同步，甚至在线聊天功能，让平台更具社区属性。
3.  **个性化推荐**：在积累了足够的用户行为数据后，可以开发一套简单的推荐算法，根据用户的浏览历史、收藏和报名记录，为他们推荐可能感兴趣的活动。

总而言之，这次大作业是一次宝贵的综合性训练，它让我将理论知识真正落地为看得见、摸得着的产品，也让我对Web全栈开发的完整图景有了更深刻的理解。

---

## 4．主要源代码（节选）

以下为项目中部分核心功能的代码实现，以展示关键逻辑。

### 4.1 `assets/app.js` - 全局应用逻辑

这是整个项目的“大脑”，负责状态管理、导航、各页面渲染和事件绑定。

```javascript
// 全局视图状态枚举
var ViewState = {
    HOME: 'HOME',
    DETAIL: 'DETAIL',
    PUBLISH: 'PUBLISH',
    STATS: 'STATS',
    FEEDBACK: 'FEEDBACK',
    CALENDAR: 'CALENDAR',
    PROFILE: 'PROFILE',
    LOGIN: 'LOGIN',
    REGISTER: 'REGISTER'
};

// localStorage 键
var LS_EVENTS_KEY = 'campushub_events';
var LS_USER_KEY = 'campushub_user';

// 全局内存变量
var events = [];
var currentUser = null;
var filter = 'all';
var searchTerm = '';

/**
 * 从 localStorage 加载状态到内存
 */
function loadState() { /* ... 实现见上文 ... */ }

/**
 * 将内存中的活动数据保存到 localStorage
 */
function saveEvents() { /* ... 实现见上文 ... */ }

/**
 * 将内存中的用户数据保存到 localStorage
 */
function saveUser() { /* ... 实现见上文 ... */ }

/**
 * 统一的页面跳转函数
 * @param {string} view - 目标视图，来自 ViewState
 * @param {object} [params] - 附加参数，如 { id: '...' }
 */
function navigate(view, params) { /* ... 实现见上文 ... */ }

/**
 * 绑定所有导航元素的点击事件
 */
function bindNav() {
    $('.nav-item').off().on('click', function () {
        var v = $(this).data('view');
        navigate(v);
    });
    // ... 其他导航元素的绑定 ...
}

/**
 * 页面总初始化函数
 */
function init() {
    loadState(); // 1. 加载持久化状态
    bindNav();   // 2. 绑定通用导航
    
    var page = $('body').data('page') || 'HOME'; // 获取当前页面标识

    // 3. 根据页面标识，调用对应的渲染函数
    switch (page) {
        case ViewState.HOME:
            renderHome();
            break;
        case ViewState.DETAIL:
            renderDetail();
            break;
        case ViewState.STATS:
            renderStats();
            break;
        // ... 其他页面的 case ...
    }
}

// 当DOM加载完毕后，执行初始化
$(init);
```

### 4.2 `assets/styles.css` - 意见反馈页定制样式

为了展示UI定制能力，这里节选了为意见反馈页特别编写的CSS代码，以实现更现代、更友好的“卡片化”和“软糖”风格。

```css
/* assets/styles.css: 反馈页增强样式 */

/* 分段式选择器容器 */
.seg-card {
    display: flex;
    background-color: #f0f0f5;
    border-radius: 12px;
    padding: 5px;
    margin-bottom: 1.5rem;
}

/* 分段式选择器单个选项 */
.seg-card .seg-item {
    flex: 1;
    text-align: center;
    padding: 10px 15px;
    cursor: pointer;
    border-radius: 9px;
    transition: all 0.3s ease;
    font-weight: 500;
    color: #555;
}

/* 分段式选择器激活状态 */
.seg-card .seg-item.active {
    background-color: #ffffff;
    color: #000;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* 浅灰色、无边框的输入框样式 */
.input-soft, .textarea-soft {
    background-color: #f8f9fa;
    border: none;
    border-radius: 12px;
    padding: 15px 20px;
    font-size: 1rem;
    width: 100%;
    transition: box-shadow 0.2s ease;
}

.input-soft:focus, .textarea-soft:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2);
    background-color: #fff;
}

/* 仿苹果风格的蓝色提交按钮 */
.btn-apple {
    background-color: #007aff;
    color: white;
    font-weight: 600;
    border-radius: 12px;
    padding: 15px 25px;
    border: none;
    transition: background-color 0.2s ease;
}

.btn-apple:hover {
    background-color: #005ecb;
    color: white;
}
```

### 4.3 页面文件结构

项目的物理文件结构清晰地反映了其模块化的设计思想。

*   `index.html`（首页）
*   `detail.html`（活动详情）
*   `publish.html`（活动发布）
*   `stats.html`（统计分析）
*   `calendar.html`（活动日历）
*   `feedback.html`（意见反馈）
*   `login.html` / `register.html`（登录/注册）
*   `profile.html`（个人中心）
*   `assets/`
    *   `app.js` (核心逻辑)
    *   `styles.css` (全局及定制样式)
    *   `vendor/` (存放jQuery, Bootstrap, ECharts等第三方库)
    *   `images/` (存放项目图片资源)

---

> **说明**：以上为项目报告的详细阐述与关键代码节选。完整的项目源代码、资源文件及部署说明，请参见代码仓库。
