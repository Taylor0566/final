# 深圳大学课程项目报告

**课程名称：** Web开发及人机交互导论  
**项目名称：** 期末大作业-校园活动管理平台  
**学院：** 计算机与软件学院  
**专业：** 计算机科学与技术（卓越班）  
**任课教师：** 李俊杰  
**报告人：** 梁升富  
**学号：** 2023152006  
**提交时间：** 2025.12.31  

---

## 摘要

本项目旨在设计并实现一个功能全面、交互友好的“校园活动管理平台”。平台以服务全校师生为核心，围绕活动的发布、发现、参与和管理四大环节，构建了一个完整的信息闭环。主要功能涵盖：一个动态更新、支持分类筛选与关键词搜索的**活动中心**；集图文介绍、在线报名、收藏、评论互动、扫码分享及日历（ICS）导出于一体的**活动详情页**；一个让用户可以方便地查看和管理自己已报名、已收藏活动的**个人中心**；基于 ECharts 实现的，从多个维度（如活动类型分布、热度趋势、主办方排行等）对校园活动数据进行可视化分析的**统计看板**；以及直观展示每日活动的**活动日历**和用于收集用户建议的**意见反馈**系统。

为了在传统多页面应用（MPA）架构下实现流畅的类单页面应用（SPA）体验，项目巧妙地运用 `localStorage` 进行状态持久化，确保了用户登录信息、活动数据在页面跳转间的无缝传递。项目整体采用响应式布局设计，兼容桌面和移动设备，并通过统一的导航栏和集中的脚本管理，保证了代码的模块化与可维护性。

---

## 1．网页页面结构规划与内容设计

项目的设计初心是打造一个信息清晰、操作便捷、体验流畅的校园活动门户。为此，我们对平台的整体结构和每个页面的内容进行了细致的规划。

*   **统一的顶部导航栏**：这是贯穿整个平台的主动脉。我们将其设计为固定在页面顶部，包含了“首页”、“活动日历”、“发布活动”、“统计分析”、“意见反馈”和“个人中心”等核心功能入口。这样的设计确保了用户无论身处哪个页面，都能快速、明确地跳转到目标模块，提供了稳定、一致的导航预期。在移动端，该导航栏会智能地折叠成一个汉堡菜单，以节省宝贵的屏幕空间。

*   **首页 (`index.html`)**：作为平台的门面，首页的设计重点是“引导”和“发现”。
    *   **内容设计**：页面顶部是醒目的**滚动宣传卡片**，用于推广精选或热门活动。紧接着是**分类筛选器**，允许用户按“学术”、“艺术”、“体育”等类别快速过滤感兴趣的内容。页面的核心是**活动网格**，以卡片形式直观展示活动海报、标题和基本信息。搜索框具备**实时搜索建议**功能，用户输入关键词时，会动态匹配并展示相关活动，极大地提升了搜索效率。
    *   **结构规划**：我们采用“上中下”的经典布局，顶部导航，中部核心内容，底部页脚。这种结构符合大多数用户的浏览习惯，逻辑清晰，重点突出。

*   **活动详情页 (`detail.html`)**：这是用户深入了解和参与活动的“最后一公里”，设计重点是“详尽”与“互动”。
    *   **内容设计**：页面以大尺寸的**活动海报**作为视觉焦点。主体部分详细展示了活动的**基本信息**（时间、地点、主办方）、丰富的**图文详情**、以及一个开放的**评论区**。核心交互功能包括**“立即报名”**和**“收藏”**按钮。此外，我们还加入了**二维码分享**和**ICS日历文件导出**功能，方便用户将活动分享给朋友或添加到自己的日程管理工具中。
    *   **结构规划**：采用左侧信息展示、右侧操作面板（或上下布局）的结构，让用户在阅读详情的同时，可以随时进行报名、收藏等操作。

*   **活动发布页 (`publish.html`)**：为活动组织者设计，重点是“便捷”和“规范”。页面提供了一个结构化的**表单**，引导用户逐项填写活动标题、时间、地点、类型、人数限制、主办方和详细介绍等所有必要信息，确保了平台活动信息的完整性和一致性。

*   **统计分析页 (`stats.html`)**：这是一个数据驱动的决策支持模块。我们选用强大的 ECharts 图表库，将后台数据转化为直观的**可视化图表**，包括：分析各类活动占比的**饼图**、展示活动发布数量变化的**折线图**、对比不同主办方活动数量的**柱状图**，以及综合评估活动各项指标的**雷达图**。

*   **活动日历页 (`calendar.html`)**：提供一个以“月”为单位的**日历视图**。用户可以直观地看到整个月中哪些天有活动，点击具体日期，下方会联动展示当日的所有活动列表，为用户的长期规划提供了便利。

*   **意见反馈页 (`feedback.html`)**：为了提升用户体验，我们设计了一个**卡片化**的反馈表单，视觉上更轻盈、友好。表单包含**分段式问题类型选择**、标题、详细描述和联系方式输入框。提交按钮固定在页脚，无论用户在页面的哪个位置，都能方便地完成提交。

*   **个人中心 (`profile.html`)**：用户的专属空间。页面顶部是可自定义的**封面和个人信息**，下方通过标签页（Tabs）清晰地划分了**“我的活动”**（已报名）、**“我的收藏”**和**“我的动态”**等模块，方便用户追踪和管理与自己相关的活动。

---

## 2．网页的实现（主要步骤解释及实现代码等）

在实现层面，我们以原生 JavaScript (ES6) 和 jQuery 为主要技术栈，配合 Bootstrap 5 进行响应式布局，并利用 ECharts 进行数据可视化。核心的挑战在于如何在没有后端和前端框架的情况下，构建一个体验流畅、状态可控的多页面应用。

### 2.1 核心机制：跨页面导航与状态持久化

**问题背景**：作为一个多页面的网站，当用户从首页跳转到详情页，或者登录后返回上一页时，如何保持他的登录状态或保留已有的活动数据？如果完全依赖服务器，每次页面加载都会重新请求，体验不佳。

**解决方案**：我们设计了一套基于浏览器 `localStorage` 的客户端状态持久化机制。`localStorage` 允许我们在用户浏览器中存储少量数据，且这些数据在浏览器关闭后依然存在。

**实现步骤**：
1.  **定义状态**：首先，我们在全局脚本 `assets/app.js` 中定义了两个关键的存储键（`LS_EVENTS_KEY` 和 `LS_USER_KEY`），分别用于存储所有的活动数据和当前登录用户的信息。

2.  **封装状态读写函数**：我们创建了 `loadState()`、`saveEvents()` 和 `saveUser()` 三个核心函数。
    *   `loadState()`: 在应用初始化时调用，尝试从 `localStorage` 中读取并解析（`JSON.parse`）活动和用户信息，将其加载到内存的变量（`events` 和 `currentUser`）中。
    *   `saveEvents()` / `saveUser()`: 当活动数据（如新增活动、报名）或用户信息（如登录、注销）发生变化时，调用这两个函数。它们会将内存中的JavaScript对象序列化为JSON字符串（`JSON.stringify`），然后存入 `localStorage`。

    ```javascript
    // assets/app.js: 状态管理核心代码
    var LS_EVENTS_KEY = 'campushub_events';
    var LS_USER_KEY = 'campushub_user';
    var events = []; // 内存中的活动数据
    var currentUser = null; // 内存中的用户数据

    function loadState() {
        try {
            var eventsString = localStorage.getItem(LS_EVENTS_KEY);
            if (eventsString) {
                events = JSON.parse(eventsString);
            }
            var userString = localStorage.getItem(LS_USER_KEY);
            if (userString) {
                currentUser = JSON.parse(userString);
            }
        } catch (e) {
            console.error("Failed to load state from localStorage", e);
        }
    }

    function saveEvents() {
        try {
            localStorage.setItem(LS_EVENTS_KEY, JSON.stringify(events));
        } catch (e) {
            console.error("Failed to save events to localStorage", e);
        }
    }

    function saveUser() {
        try {
            if (currentUser) {
                localStorage.setItem(LS_USER_KEY, JSON.stringify(currentUser));
            } else {
                localStorage.removeItem(LS_USER_KEY); // 注销时清除用户数据
            }
        } catch (e) {
            console.error("Failed to save user to localStorage", e);
        }
    }
    ```

3.  **统一导航函数**：为了集中管理页面跳转，我们创建了 `navigate(view, params)` 函数。此函数不仅负责跳转，更承担了在跳转前**自动保存状态**的职责。
    *   它通过一个 `map` 对象，将抽象的视图名称（如 `ViewState.DETAIL`）映射到实际的HTML文件名（如 `detail.html`）。
    *   它能处理URL参数。例如，跳转到详情页时，会将活动ID（`params.id`）作为查询字符串（`?id=...`）拼接到URL上。
    *   最关键的是，在执行 `window.location.href` 跳转之前，它会先调用 `saveUser()` 和 `saveEvents()`，确保任何未保存的更改都已持久化。

    ```javascript
    // assets/app.js: 统一页面导航函数
    function navigate(view, params) {
        var map = {
            HOME: 'index.html',
            DETAIL: 'detail.html',
            PUBLISH: 'publish.html',
            STATS: 'stats.html',
            CALENDAR: 'calendar.html',
            FEEDBACK: 'feedback.html',
            PROFILE: 'profile.html',
            LOGIN: 'login.html',
            REGISTER: 'register.html'
        };
        var url = map[view] || 'index.html';

        if (view === ViewState.DETAIL && params && params.id) {
            url += '?id=' + encodeURIComponent(params.id);
        }
        
        // 在跳转前保存所有状态
        saveUser();
        saveEvents();
        
        window.location.href = url;
    }
    ```

通过这套机制，我们成功地在多个独立的HTML页面之间建立起了状态共享的桥梁，极大地提升了用户体验的连贯性。

### 2.2 首页实现：活动展示、分类筛选与搜索建议

首页是用户与平台交互的第一站，其实现重点在于高效地展示信息和快速地响应用户操作。

**实现步骤**：
1.  **动态渲染活动网格**：`renderHome()` 函数是首页渲染的核心。
    *   它首先会根据用户选择的**分类（`filter`）**和输入的**搜索词（`searchTerm`）**，对内存中的 `events` 数组进行双重过滤。
    *   接着，它会清空现有的活动网格（`#event-grid`），然后遍历筛选后的活动列表。
    *   对于每一个活动，它会动态创建一个Bootstrap卡片（`div.card`），填充上活动的图片、标题、日期等信息，并将其追加到网格中。
    *   每个卡片都被绑定了一个点击事件，点击后调用 `navigate(ViewState.DETAIL, { id: ev.id })`，将用户引导至对应的详情页。

2.  **分类筛选功能**：`renderHome()` 函数在执行时，也会动态生成分类按钮。它会检查当前的 `filter` 值，为对应的分类按钮添加 `btn-dark` 的激活样式，并为每个按钮绑定点击事件。点击后，更新全局 `filter` 变量，并重新调用 `renderHome()` 来刷新视图。

3.  **搜索建议（联想）**：为了优化搜索体验，我们实现了 `updateSearchInput()` 函数。
    *   该函数在搜索框的 `input` 事件上触发。
    *   它获取输入框的当前值，并与 `events` 数组中的活动标题和分类进行模糊匹配。
    *   如果找到匹配项，它会创建一个下拉建议框（`#search-suggest`），将匹配度最高的几个活动展示出来，并为每个建议项绑定点击事件，直接跳转到该活动的详情页。
    *   如果没有输入或没有匹配项，则隐藏建议框。

    ```javascript
    // assets/app.js: 首页渲染与交互的部分实现
    function renderHome() {
        // ... 分类按钮渲染逻辑 ...

        var grid = $('#event-grid');
        grid.empty(); // 清空旧内容
        var term = searchTerm.toLowerCase();
        
        // 过滤活动
        var filteredEvents = events.filter(function(e) {
            var matchesSearch = (e.title.toLowerCase().indexOf(term) > -1 || e.description.toLowerCase().indexOf(term) > -1);
            var matchesFilter = (filter === 'all' || e.category === filter);
            return matchesSearch && matchesFilter;
        });

        // 渲染卡片
        filteredEvents.forEach(function(ev) {
            var card = $('<div class="col-md-4 mb-4">...</div>'); // 卡片HTML结构
            // ... 填充卡片内容 ...
            card.on('click', function() {
                navigate(ViewState.DETAIL, { id: ev.id });
            });
            grid.append(card);
        });
    }
    ```

### 2.3 活动详情页实现：动态内容加载与核心交互

详情页需要根据URL中的ID，动态展示特定活动的信息。

**实现步骤**：
1.  **解析URL参数**：`renderDetail()` 函数首先通过 `URLSearchParams` API 从 `window.location.search` 中解析出 `id` 参数。
2.  **查找数据并渲染**：根据获取到的 `id`，在 `events` 数组中找到对应的活动对象。如果找不到，则显示错误信息或跳转回首页。找到后，使用jQuery将活动的标题、海报、图文详情、评论等信息填充到页面的各个DOM元素中。
3.  **报名与收藏功能**：
    *   按钮的状态（例如，显示“报名”还是“已报名”）会根据 `currentUser` 是否在活动的 `registeredUsers` 数组中来决定。
    *   点击按钮时，会更新 `events` 数组中对应活动的数据（添加或移除用户ID），然后立即调用 `saveEvents()` 将更改持久化到 `localStorage`，并重新渲染按钮状态，实现即时反馈。
4.  **ICS文件生成与导出**：当用户点击“添加到日历”时，我们会动态生成一个符合 iCalendar 规范的文本字符串，包含活动的标题、时间、地点等信息。然后，通过创建一个 `Blob` 对象和 `<a>` 标签的 `download` 属性，将该字符串作为 `.ics` 文件触发浏览器下载。

### 2.4 数据可视化：ECharts的应用

统计页 `stats.html` 的核心是 `renderStats()` 函数。

**实现步骤**：
1.  **数据聚合**：在渲染图表前，我们需要先对 `events` 数组进行处理，聚合出图表所需的数据。例如，要渲染饼图，我们需要统计每个分类（`category`）下有多少个活动。
2.  **初始化ECharts实例**：为每个图表容器（如 `#echarts-pie`）调用 `echarts.init()` 来创建一个ECharts实例。
3.  **配置与渲染**：为每个实例构建一个 `option` 配置对象，将聚合好的数据填入 `series` 中，并设置好标题、图例、坐标轴等样式。最后，调用实例的 `setOption(option)` 方法，ECharts便会自动将数据渲染成绚丽的图表。

    ```javascript
    // assets/app.js: ECharts渲染示例
    function renderStats() {
        // 1. 数据聚合
        var categoryCounts = events.reduce(function(acc, ev) {
            acc[ev.category] = (acc[ev.category] || 0) + 1;
            return acc;
        }, {});
        var pieData = Object.keys(categoryCounts).map(function(key) {
            return { name: key, value: categoryCounts[key] };
        });

        // 2. 初始化实例
        var pieChart = echarts.init(document.getElementById('echarts-pie'));
        
        // 3. 配置与渲染
        var pieOption = {
            title: { text: '活动分类占比' },
            series: [{
                type: 'pie',
                radius: '50%',
                data: pieData
            }]
        };
        pieChart.setOption(pieOption);

        // ... 其他图表（折线图、柱状图等）的实现与此类似 ...
    }
    ```

---

## 3．项目总结

本次课程项目从零到一构建了一个功能相对完备的校园活动管理平台。整个过程不仅是对课堂所学Web开发知识的一次全面检验和实践，更是一次关于产品设计、用户体验和工程思维的深度探索。

在项目架构上，我们选择了一条务实的路线。在没有引入重型前端框架的前提下，通过原生JavaScript和 `localStorage` 构建了一套轻量级的状态管理和导航机制，成功地在多页面应用中模拟出了单页面应用的流畅体验。这种设计虽然在复杂性上有所妥协，但换来了极低的上手门槛和高度的灵活性，证明了即使是基础技术，只要巧妙组合，也能构建出交互完善的现代化应用。

**项目挑战与解决方案**：
*   **挑战一：跨页面的状态一致性**。这是本次项目的核心难题。我们最终通过设计统一的 `navigate` 函数，强制在每次页面跳转前执行 `saveState` 操作，形成了一个“修改-保存-跳转”的原子操作流程，有效地保证了数据在不同视图间的同步。
*   **挑战二：响应式布局的精细化调试**。虽然Bootstrap提供了强大的栅格系统，但在处理特定组件（如导航栏、复杂的表单）在不同屏幕尺寸下的表现时，仍需编写大量的媒体查询（Media Queries）进行微调。我们通过反复在浏览器开发者工具中模拟不同设备，才最终打磨出较为理想的跨端体验。
*   **挑战三：前端性能优化**。在首页活动数量增多时，初版的渲染函数会导致页面卡顿。我们通过在渲染前进行数据过滤，以及未来可以引入的“虚拟列表”或“分页加载”等技术，来优化DOM操作的性能。

**心得体会与未来展望**：
通过这个项目，我深刻体会到“用户为中心”的设计思想是多么重要。一个功能的价值，不仅在于它能否实现，更在于它是否易用、好用。从搜索建议到ICS导出，这些看似微小的细节，恰恰是提升用户体验的关键。同时，我也认识到代码的模块化和规范化是项目能够持续迭代的基石。将不同页面的渲染逻辑封装在各自的 `render` 函数中，并由一个总的 `init` 函数统一调度，使得整个代码库结构清晰，易于维护。

展望未来，这个项目还有巨大的提升空间：
1.  **后端整合**：目前的数据存储在 `localStorage`，这只是一个前端模拟。下一步最关键的升级就是引入真正的后端服务（如 Node.js + Express）和数据库（如 MongoDB 或 MySQL），实现用户注册、活动数据的持久化存储和更复杂的权限管理。
2.  **实时交互**：引入 WebSocket 技术，可以实现活动评论的实时更新、报名人数的实时同步，甚至在线聊天功能，让平台更具社区属性。
3.  **个性化推荐**：在积累了足够的用户行为数据后，可以开发一套简单的推荐算法，根据用户的浏览历史、收藏和报名记录，为他们推荐可能感兴趣的活动。

总而言之，这次大作业是一次宝贵的综合性训练，它让我将理论知识真正落地为看得见、摸得着的产品，也让我对Web全栈开发的完整图景有了更深刻的理解。

---

## 4．主要源代码（节选）

以下为项目中部分核心功能的代码实现，以展示关键逻辑。

### 4.1 `assets/app.js` - 全局应用逻辑

这是整个项目的“大脑”，负责状态管理、导航、各页面渲染和事件绑定。

```javascript
// 全局视图状态枚举
var ViewState = {
    HOME: 'HOME',
    DETAIL: 'DETAIL',
    PUBLISH: 'PUBLISH',
    STATS: 'STATS',
    FEEDBACK: 'FEEDBACK',
    CALENDAR: 'CALENDAR',
    PROFILE: 'PROFILE',
    LOGIN: 'LOGIN',
    REGISTER: 'REGISTER'
};

// localStorage 键
var LS_EVENTS_KEY = 'campushub_events';
var LS_USER_KEY = 'campushub_user';

// 全局内存变量
var events = [];
var currentUser = null;
var filter = 'all';
var searchTerm = '';

/**
 * 从 localStorage 加载状态到内存
 */
function loadState() { /* ... 实现见上文 ... */ }

/**
 * 将内存中的活动数据保存到 localStorage
 */
function saveEvents() { /* ... 实现见上文 ... */ }

/**
 * 将内存中的用户数据保存到 localStorage
 */
function saveUser() { /* ... 实现见上文 ... */ }

/**
 * 统一的页面跳转函数
 * @param {string} view - 目标视图，来自 ViewState
 * @param {object} [params] - 附加参数，如 { id: '...' }
 */
function navigate(view, params) { /* ... 实现见上文 ... */ }

/**
 * 绑定所有导航元素的点击事件
 */
function bindNav() {
    $('.nav-item').off().on('click', function () {
        var v = $(this).data('view');
        navigate(v);
    });
    // ... 其他导航元素的绑定 ...
}

/**
 * 页面总初始化函数
 */
function init() {
    loadState(); // 1. 加载持久化状态
    bindNav();   // 2. 绑定通用导航
    
    var page = $('body').data('page') || 'HOME'; // 获取当前页面标识

    // 3. 根据页面标识，调用对应的渲染函数
    switch (page) {
        case ViewState.HOME:
            renderHome();
            break;
        case ViewState.DETAIL:
            renderDetail();
            break;
        case ViewState.STATS:
            renderStats();
            break;
        // ... 其他页面的 case ...
    }
}

// 当DOM加载完毕后，执行初始化
$(init);
```

### 4.2 `assets/styles.css` - 意见反馈页定制样式

为了展示UI定制能力，这里节选了为意见反馈页特别编写的CSS代码，以实现更现代、更友好的“卡片化”和“软糖”风格。

```css
/* assets/styles.css: 反馈页增强样式 */

/* 分段式选择器容器 */
.seg-card {
    display: flex;
    background-color: #f0f0f5;
    border-radius: 12px;
    padding: 5px;
    margin-bottom: 1.5rem;
}

/* 分段式选择器单个选项 */
.seg-card .seg-item {
    flex: 1;
    text-align: center;
    padding: 10px 15px;
    cursor: pointer;
    border-radius: 9px;
    transition: all 0.3s ease;
    font-weight: 500;
    color: #555;
}

/* 分段式选择器激活状态 */
.seg-card .seg-item.active {
    background-color: #ffffff;
    color: #000;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* 浅灰色、无边框的输入框样式 */
.input-soft, .textarea-soft {
    background-color: #f8f9fa;
    border: none;
    border-radius: 12px;
    padding: 15px 20px;
    font-size: 1rem;
    width: 100%;
    transition: box-shadow 0.2s ease;
}

.input-soft:focus, .textarea-soft:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2);
    background-color: #fff;
}

/* 仿苹果风格的蓝色提交按钮 */
.btn-apple {
    background-color: #007aff;
    color: white;
    font-weight: 600;
    border-radius: 12px;
    padding: 15px 25px;
    border: none;
    transition: background-color 0.2s ease;
}

.btn-apple:hover {
    background-color: #005ecb;
    color: white;
}
```

### 4.3 页面文件结构

项目的物理文件结构清晰地反映了其模块化的设计思想。

*   `index.html`（首页）
*   `detail.html`（活动详情）
*   `publish.html`（活动发布）
*   `stats.html`（统计分析）
*   `calendar.html`（活动日历）
*   `feedback.html`（意见反馈）
*   `login.html` / `register.html`（登录/注册）
*   `profile.html`（个人中心）
*   `assets/`
    *   `app.js` (核心逻辑)
    *   `styles.css` (全局及定制样式)
    *   `vendor/` (存放jQuery, Bootstrap, ECharts等第三方库)
    *   `images/` (存放项目图片资源)

---

> **说明**：以上为项目报告的详细阐述与关键代码节选。完整的项目源代码、资源文件及部署说明，请参见代码仓库。
